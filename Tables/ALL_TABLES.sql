-- MYSQL SCRIPT GENERATED BY MYSQL WORKBENCH
-- FRI OCT  1 23:07:00 2021
-- MODEL: NEW MODEL    VERSION: 1.0
-- MYSQL WORKBENCH FORWARD ENGINEERING

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- SCHEMA DB_COMERCIO
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `DB_COMERCIO` ;

-- -----------------------------------------------------
-- SCHEMA DB_COMERCIO
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `DB_COMERCIO` DEFAULT CHARACTER SET LATIN1 ;
USE `DB_COMERCIO` ;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`ESTADO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`ESTADO` (
  `COD_ESTADO` INT NOT NULL AUTO_INCREMENT,
  `NME_ESTADO` VARCHAR(100) NOT NULL,
  `SGL_UF` VARCHAR(2) NOT NULL,
  PRIMARY KEY (`COD_ESTADO`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`MUNICIPIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`MUNICIPIO` (
  `COD_MUNICIPIO` INT NOT NULL AUTO_INCREMENT,
  `NME_MUNICIPIO` VARCHAR(100) NOT NULL,
  `COD_ESTADO` INT NOT NULL,
  PRIMARY KEY (`COD_MUNICIPIO`),
  INDEX `FK_MUNICIPIO_ESTADO_IDX` (`COD_ESTADO` ASC) ,
  CONSTRAINT `FK_MUNICIPIO_ESTADO`
    FOREIGN KEY (`COD_ESTADO`)
    REFERENCES `DB_COMERCIO`.`ESTADO` (`COD_ESTADO`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`BAIRRO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`BAIRRO` (
  `COD_BAIRRO` INT NOT NULL AUTO_INCREMENT,
  `NME_BAIRRO` VARCHAR(100) NOT NULL,
  `COD_MUNICIPIO` INT NULL ,
  PRIMARY KEY (`COD_BAIRRO`),
  INDEX `FK_BAIRRO_MUNICIPIO_IDX` (`COD_MUNICIPIO` ASC) ,
  INDEX `IDX_BAIRRO` (`NME_BAIRRO` ASC) ,
  CONSTRAINT `FK_BAIRRO_MUNICIPIO`
    FOREIGN KEY (`COD_MUNICIPIO`)
    REFERENCES `DB_COMERCIO`.`MUNICIPIO` (`COD_MUNICIPIO`))
ENGINE = InnoDB
AUTO_INCREMENT = 35182
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`CATEGORIA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`CATEGORIA` (
  `COD_CATEGORIA` INT NOT NULL AUTO_INCREMENT,
  `NME_CATEGORIA` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`COD_CATEGORIA`))
ENGINE = InnoDB
AUTO_INCREMENT = 5
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`PESSOA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`USUARIO` (
  `COD_PESSOA` INT NOT NULL AUTO_INCREMENT,
  `DSC_LOGIN` VARCHAR(20) NULL ,
  `DSC_SENHA` VARCHAR(128) NULL ,
  `FLG_ATIVO` TINYINT NULL,
  PRIMARY KEY (`COD_PESSOA`)
)  
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`PESSOA_FISICA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`PESSOA_FISICA` (
  `COD_PESSOA` INT NOT NULL AUTO_INCREMENT,
  `NME_PESSOA` VARCHAR(100),
  `SGL_UF_NATURALIDADE` CHAR(2),
  `DTA_NASCIMENTO` DATE NOT NULL,
  `TPO_SEXO` ENUM('M', 'F', 'N') comment 'M - MASCULINO; F - FEMININO; N - NEUTRO',
  `COD_USUARIO` INT NOT NULL,
  PRIMARY KEY (`COD_PESSOA`),
  INDEX `FK_PESSOA_FISICA_PESSOA_IDX` (`COD_PESSOA` ASC) ,
  CONSTRAINT `FK_PESSOA_FISICA_USUARIO`
    FOREIGN KEY (`COD_USUARIO`)
    REFERENCES `DB_COMERCIO`.`USUARIO` (`COD_USUARIO`)
)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`PESSOA_JURIDICA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`PESSOA_JURIDICA` (
  `COD_PESSOA` INT NOT NULL AUTO_INCREMENT,
  `NME_RAZAO_SOCIAL` VARCHAR(200) NOT NULL,
  `NME_FANTASIA` VARCHAR(200) NOT NULL,
  `COD_USUARIO` INT NOT NULL,
  PRIMARY KEY (`COD_PESSOA`),
  INDEX `FK_PESSOA_JURIDICA_PESSOA_IDX` (`COD_PESSOA` ASC) ,
  CONSTRAINT `FK_PESSOA_JURIDICA_USUARIO`
    FOREIGN KEY (`COD_USUARIO`)
    REFERENCES `DB_COMERCIO`.`USUARIO` (`COD_USUARIO`)
)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;

-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`OPERACAO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `db_comercio`.`operacao` (
  `COD_OPERACAO` INT NOT NULL AUTO_INCREMENT,
  `DTA_OPERACAO` DATETIME NULL DEFAULT NULL,
  `COD_NOTA_FISCAL` INT NULL DEFAULT NULL,
  `VRL_TOTAL` DECIMAL(10,2) NULL DEFAULT NULL,
  `QTD_PARCELA` INT NULL DEFAULT NULL,
  `TPO_STATUS` ENUM('P', 'O') NULL DEFAULT NULL COMMENT 'P - pedido (compra ou venda); O - or√ßamento\\n',
  `COD_PESSOA` INT NULL DEFAULT NULL,
  `FLG_PAGO` TINYINT NULL DEFAULT NULL,
  `TPO_OPERACAO` ENUM('C', 'V') NULL DEFAULT NULL COMMENT 'C - Compra; V - Venda',
  PRIMARY KEY (`COD_OPERACAO`),
  INDEX `FK_OPERACAO_PESSOA_idx` (`COD_PESSOA` ASC) VISIBLE,
  CONSTRAINT `FK_OPERACAO_PESSOA`
    FOREIGN KEY (`COD_PESSOA`)
    REFERENCES `db_comercio`.`PESSOA` (`COD_PESSOA`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`LOGRADOURO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`LOGRADOURO` (
  `COD_CEP` INT NOT NULL AUTO_INCREMENT,
  `COD_BAIRRO` INT NOT NULL,
  `DSC_LOGRADOURO` VARCHAR(255) NULL ,
  `DSC_COMPLEMENTO` VARCHAR(255) NULL ,
  PRIMARY KEY (`COD_CEP`, `COD_BAIRRO`),
  INDEX `FK_BAIRRO_ENDERECO_IDX` (`COD_BAIRRO` ASC) ,
  CONSTRAINT `FK_BAIRRO_ENDERECO`
    FOREIGN KEY (`COD_BAIRRO`)
    REFERENCES `DB_COMERCIO`.`BAIRRO` (`COD_BAIRRO`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`FORNECEDOR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`FORNECEDOR` (
  `COD_FORNECEDOR` INT NOT NULL AUTO_INCREMENT,
  `COD_PESSOA` INT NOT NULL,
  `NME_RAZAO_SOCIAL` VARCHAR(95) NULL ,
  PRIMARY KEY (`COD_FORNECEDOR`, `COD_PESSOA`),
  INDEX `FK_FORNECEDOR_PESSOA_IDX` (`COD_PESSOA` ASC) ,
  CONSTRAINT `FK_FORNECEDOR_PESSOA`
    FOREIGN KEY (`COD_PESSOA`)
    REFERENCES `DB_COMERCIO`.`PESSOA` (`COD_PESSOA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`SUBCATEGORIA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`SUBCATEGORIA` (
  `COD_SUBCATEGORIA` INT NOT NULL AUTO_INCREMENT,
  `NME_SUBCATEGORIA` VARCHAR(95) NULL ,
  `COD_CATEGORIA` INT NULL ,
  PRIMARY KEY (`COD_SUBCATEGORIA`),
  INDEX `FK_SUBCATEGORIA_CATEGORA_IDX` (`COD_CATEGORIA` ASC) ,
  CONSTRAINT `FK_SUBCATEGORIA_CATEGORA`
    FOREIGN KEY (`COD_CATEGORIA`)
    REFERENCES `DB_COMERCIO`.`CATEGORIA` (`COD_CATEGORIA`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`UNIDADE_MEDIDA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`UNIDADE_MEDIDA` (
  `COD_UNIDADE_MEDIDA` INT NOT NULL AUTO_INCREMENT,
  `NME_UNIDADE_MEDIDA` VARCHAR(100) NULL ,
  `SGL_UNIDADE_MEDIDA` VARCHAR(50) NULL,
  PRIMARY KEY (`COD_UNIDADE_MEDIDA`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`PRODUTO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`PRODUTO` (
  `COD_PRODUTO` INT NOT NULL AUTO_INCREMENT,
  `NME_PRODUTO` VARCHAR(95) NULL ,
  `DSC_PRODUTO` VARCHAR(255) NULL ,
  `COD_SUBCATEGORIA` INT NULL ,
  `COD_UNIDADE_MEDIDA` INT NULL ,
  PRIMARY KEY (`COD_PRODUTO`),
  INDEX `FK_PRODUTO_SUBCATEGORIA_IDX` (`COD_SUBCATEGORIA` ASC) ,
  INDEX `FK_PRODUTO_UNIDADE_MEDIDA_IDX` (`COD_UNIDADE_MEDIDA` ASC) ,
  CONSTRAINT `FK_PRODUTO_SUBCATEGORIA`
    FOREIGN KEY (`COD_SUBCATEGORIA`)
    REFERENCES `DB_COMERCIO`.`SUBCATEGORIA` (`COD_SUBCATEGORIA`),
  CONSTRAINT `FK_PRODUTO_UNIDADE_MEDIDA`
    FOREIGN KEY (`COD_UNIDADE_MEDIDA`)
    REFERENCES `DB_COMERCIO`.`UNIDADE_MEDIDA` (`COD_UNIDADE_MEDIDA`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`ITEM_OPERACAO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`ITEM_OPERACAO` (
  `COD_ITEM_OPERACAO` INT NOT NULL AUTO_INCREMENT,
  `QTD_ITEM` FLOAT NULL ,
  `VLR_ITEM` DECIMAL(10,2) NULL ,
  `COD_OPERACAO` INT NOT NULL,
  `COD_PRODUTO` INT NOT NULL,
  PRIMARY KEY (`COD_ITEM_OPERACAO`),
  INDEX `FK_ITEM_COMPRA_IDX` (`COD_OPERACAO` ASC) ,
  INDEX `FK_ITEM_COMPRA_PRODUTO_IDX` (`COD_PRODUTO` ASC) ,
  CONSTRAINT `FK_ITEM_COMPRA`
    FOREIGN KEY (`COD_OPERACAO`)
    REFERENCES `DB_COMERCIO`.`OPERACAO` (`COD_OPERACAO`),
  CONSTRAINT `FK_ITEM_COMPRA_PRODUTO`
    FOREIGN KEY (`COD_PRODUTO`)
    REFERENCES `DB_COMERCIO`.`PRODUTO` (`COD_PRODUTO`))
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`TIPO_PAGAMENTO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`TIPO_PAGAMENTO` (
  `COD_TIPO_PAGAMENTO` INT NOT NULL AUTO_INCREMENT,
  `NME_TIPO_PAGAMENTO` VARCHAR(90) NULL ,
  PRIMARY KEY (`COD_TIPO_PAGAMENTO`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`PAGAMENTO_OPERACAO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`PAGAMENTO_OPERACAO` (
  `COD_PAGAMENTO` INT NOT NULL AUTO_INCREMENT,
  `VLR_PAGAMENTO` DECIMAL(10,2) NULL ,
  `DTA_PAGAMENTO` DATE NULL ,
  `DTA_VENCIMENTO` DATE NULL ,
  `COD_OPERACAO` INT NOT NULL,
  `COD_TIPO_PAGAMENTO` INT NULL,
  PRIMARY KEY (`COD_PAGAMENTO`),
  INDEX `FK_PARCELA_COMPRA_IDX` (`COD_OPERACAO` ASC) ,
  INDEX `FK_TIPO_PAGAMENTO_OPERACAO__idx` (`COD_TIPO_PAGAMENTO` ASC) ,
  CONSTRAINT `FK_PARCELA_COMPRA`
    FOREIGN KEY (`COD_OPERACAO`)
    REFERENCES `DB_COMERCIO`.`OPERACAO` (`COD_OPERACAO`),
  CONSTRAINT `FK_TIPO_PAGAMENTO_OPERACAO_`
    FOREIGN KEY (`COD_TIPO_PAGAMENTO`)
    REFERENCES `DB_COMERCIO`.`TIPO_PAGAMENTO` (`COD_TIPO_PAGAMENTO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;

/
-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`USUARIO`
-- -----------------------------------------------------
CREATE TABLE `usuario` (
  `COD_USUARIO` int NOT NULL AUTO_INCREMENT,
  `DSC_LOGIN` varchar(20) DEFAULT NULL,
  `DSC_SENHA` varchar(128) DEFAULT NULL,
  `FLG_ATIVO` tinyint DEFAULT NULL,
  `COD_PESSOA` int DEFAULT NULL,
  PRIMARY KEY (`COD_USUARIO`),
  UNIQUE KEY `DSC_LOGIN_UNIQUE` (`DSC_LOGIN`),
  KEY `FK_USUARIO_PESSOA` (`COD_PESSOA`),
  CONSTRAINT `FK_USUARIO_PESSOA` FOREIGN KEY (`COD_PESSOA`) REFERENCES `pessoa` (`COD_PESSOA`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`ENDERECO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`ENDERECO` (
  `COD_ENDERECO` INT NOT NULL,
  `DSC_COMPLEMENTO` VARCHAR(255) NULL,
  `NRO_ENDERECO` INT NULL,
  `DSC_PONTO_REFERENCIA` VARCHAR(255) NULL,
  `COD_CEP` INT NULL,
  `COD_PESSOA` INT NULL,
  PRIMARY KEY (`COD_ENDERECO`),
  INDEX `FK_ENDERECO_LOGRADOURO_idx` (`COD_CEP` ASC) ,
  INDEX `FK_ENDERECO_PESSOA_idx` (`COD_PESSOA` ASC) ,
  CONSTRAINT `FK_ENDERECO_LOGRADOURO`
    FOREIGN KEY (`COD_CEP`)
    REFERENCES `DB_COMERCIO`.`LOGRADOURO` (`COD_CEP`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ENDERECO_PESSOA`
    FOREIGN KEY (`COD_PESSOA`)
    REFERENCES `DB_COMERCIO`.`PESSOA` (`COD_PESSOA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_COMERCIO`.`ESTOQUE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `DB_COMERCIO`.`ESTOQUE` (
  `PRODUTO_COD_PRODUTO` INT NOT NULL,
  `VLR_UNITARIO` INT NULL,
  PRIMARY KEY (`PRODUTO_COD_PRODUTO`),
  INDEX `fk_PRODUTO_has_OPERACAO_PRODUTO1_idx` (`PRODUTO_COD_PRODUTO` ASC) ,
  CONSTRAINT `fk_PRODUTO_has_OPERACAO_PRODUTO1`
    FOREIGN KEY (`PRODUTO_COD_PRODUTO`)
    REFERENCES `DB_COMERCIO`.`PRODUTO` (`COD_PRODUTO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
